<?xml version="1.0" encoding="utf-8" ?>
<sqlMap namespace="Product">

  <!-- Get all products -->
  <select id="Product.GetAll" resultType="WSC.DataAccess.Examples.Models.Product">
    SELECT
      Id,
      ProductCode,
      ProductName,
      Description,
      Price,
      StockQuantity,
      Category,
      CreatedDate,
      UpdatedDate,
      IsActive
    FROM Products
    WHERE IsActive = 1
    ORDER BY ProductName
  </select>

  <!-- Get product by ID -->
  <select id="Product.GetById" resultType="WSC.DataAccess.Examples.Models.Product">
    SELECT
      Id,
      ProductCode,
      ProductName,
      Description,
      Price,
      StockQuantity,
      Category,
      CreatedDate,
      UpdatedDate,
      IsActive
    FROM Products
    WHERE Id = @Id
  </select>

  <!-- Get products by category -->
  <select id="Product.GetByCategory" resultType="WSC.DataAccess.Examples.Models.Product">
    SELECT
      Id,
      ProductCode,
      ProductName,
      Description,
      Price,
      StockQuantity,
      Category,
      CreatedDate,
      UpdatedDate,
      IsActive
    FROM Products
    WHERE Category = @Category AND IsActive = 1
    ORDER BY ProductName
  </select>

  <!-- Get products with low stock -->
  <select id="Product.GetLowStock" resultType="WSC.DataAccess.Examples.Models.Product">
    SELECT
      Id,
      ProductCode,
      ProductName,
      Description,
      Price,
      StockQuantity,
      Category,
      CreatedDate,
      UpdatedDate,
      IsActive
    FROM Products
    WHERE StockQuantity &lt;= @Threshold AND IsActive = 1
    ORDER BY StockQuantity, ProductName
  </select>

  <!-- Insert product -->
  <insert id="Product.Insert">
    INSERT INTO Products (
      ProductCode,
      ProductName,
      Description,
      Price,
      StockQuantity,
      Category,
      CreatedDate,
      IsActive
    )
    VALUES (
      @ProductCode,
      @ProductName,
      @Description,
      @Price,
      @StockQuantity,
      @Category,
      @CreatedDate,
      @IsActive
    )
  </insert>

  <!-- Update product -->
  <update id="Product.Update">
    UPDATE Products
    SET
      ProductCode = @ProductCode,
      ProductName = @ProductName,
      Description = @Description,
      Price = @Price,
      StockQuantity = @StockQuantity,
      Category = @Category,
      UpdatedDate = @UpdatedDate,
      IsActive = @IsActive
    WHERE Id = @Id
  </update>

  <!-- Delete product (soft delete by setting IsActive = 0) -->
  <update id="Product.Delete">
    UPDATE Products
    SET IsActive = 0,
        UpdatedDate = GETDATE()
    WHERE Id = @Id
  </update>

</sqlMap>
